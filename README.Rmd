---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  dpi =  300,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# geovctrs

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
![R-CMD-check](https://github.com/paleolimbot/geovctrs/workflows/R-CMD-check/badge.svg)
[![Codecov test coverage](https://codecov.io/gh/paleolimbot/geovctrs/branch/master/graph/badge.svg)](https://codecov.io/gh/paleolimbot/geovctrs?branch=master)
<!-- badges: end -->

The goal of geovctrs is to provide a common set of classes and data structures to ensure that processing functions in the rapidly expanding R geospatial ecosystem are interchangable.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("remotes")
remotes::install_github("paleolimbot/geovctrs")
```

If you can load the package, you're good to go!

```{r example}
library(geovctrs)
```

## Example

This package has reasonable `plot()` and `print()` methods for WKB and WKT types, and provides a [vctrs](https://vctrs.r-lib.org/) implementation for these types so that they "just work" with [tibble](https://tibble.tidyverse.org/), [tidyr](https://tidyr.tidyverse.org/), and [dplyr](https://dplyr.tidyverse.org/) (>=1.0.0) (among others).

```{r}
head(geo_example_wkt)
head(as_geo_wkb(geo_example_wkt))
```

Most methods work on anything that can be interpreted as geometry, including character vectors and data.frames containing exactly one geometry column.

```{r ex-plot}
geo_plot("LINESTRING (30 10, 10 30, 40 40)")
```

Like any self-respecting geometry package, geovctrs contains a copy of the North Carolina dataset to play with:

```{r}
rev(geo_nc)
```

## sf and data frame support

The geovctrs package has tentative sf and data frame support for all processing functions, following the principle that well-mannered transformation functions return the same type and shape as the input. For data frames with exactly one geovctr column, transformation functions replace the output column with another geovctr (this might be of a different type, but will be a geovctr).

```{r}
geo_envelope(rev(geo_nc))
```

For sf objects, this means that valid sf objects are returned:

```{r}
library(sf)
sf_nc <- read_sf(system.file("shape/nc.shp", package = "sf"))
geo_envelope(sf_nc)
```

Other functions that accept geometry as input will treat sf and data frame objects as vectors with the length of `nrow(x)`:

```{r sf-nc-plot}
geo_n_coordinates(sf_nc)
geo_plot(sf_nc)
```
